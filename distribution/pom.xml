<?xml version="1.0" encoding="utf-8" ?>
<!--
Copyright (C) 2014 TU Dortmund
This file is part of LearnLib, http://www.learnlib.de/.

LearnLib is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License version 3.0 as published by the Free Software Foundation.

LearnLib is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with LearnLib; if not, see
http://www.gnu.de/documents/lgpl.en.html.
-->
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>de.learnlib</groupId>
		<artifactId>learnlib-parent</artifactId>
		<version>0.10.2-SNAPSHOT</version>
		<relativePath>../pom.xml</relativePath>
	</parent>

	<groupId>de.learnlib.distribution</groupId>
	<artifactId>learnlib-distribution</artifactId>
	<packaging>pom</packaging>
	<name>LearnLib :: Distribution</name>

	<profiles>
		<profile>
			<id>bundle</id>
			<activation>
				<property>
					<name>learnlib.release</name>
					<value>true</value>
				</property>
			</activation>
			<dependencies>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-core</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-core</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>


				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-algorithm-features</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-algorithm-features</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-basic-eqtests</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-basic-eqtests</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-cache</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-cache</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-counterexamples</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-counterexamples</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-dhc</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-dhc</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-drivers-basic</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-drivers-basic</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-lstar-baseline</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-lstar-baseline</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-lstar-generic</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-lstar-generic</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-discrimination-tree</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-discrimination-tree</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-kearns-vazirani</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-kearns-vazirani</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-parallelism</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-parallelism</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-reuse</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-reuse</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-simulator</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-simulator</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-mapper</artifactId>
					<version>${project.version}</version>
				</dependency>
				<dependency>
					<groupId>de.learnlib</groupId>
					<artifactId>learnlib-mapper</artifactId>
					<version>${project.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<!-- AutomataLib dependencies - to ensure bundle completeness TODO: Having 
					to keep this up-to-date manually is somewhat error-prone; should there exist 
					something like meta-packages? -->
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-api</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-api</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-core</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-core</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-util</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-util</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-util</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-util</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-dotutil</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-dotutil</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-smartcollections</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-commons-smartcollections</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-incremental</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-incremental</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-brics</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-brics</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>

				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-misc-algorithms</artifactId>
					<version>${automatalib.version}</version>
				</dependency>
				<dependency>
					<groupId>net.automatalib</groupId>
					<artifactId>automata-misc-algorithms</artifactId>
					<version>${automatalib.version}</version>
					<classifier>sources</classifier>
				</dependency>
			</dependencies>

			<build>
				<plugins>
					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-assembly-plugin</artifactId>
						<configuration>
							<outputDirectory>${project.build.directory}/bundles</outputDirectory>
							<appendAssemblyId>true</appendAssemblyId>
							<finalName>learnlib-${project.version}</finalName>
						</configuration>
						<executions>
							<execution>
								<id>bundle</id>
								<goals>
									<goal>single</goal>
								</goals>
								<phase>package</phase>
								<configuration>
									<descriptors>
										<descriptor>src/main/assembly/learnlib-bundle.xml</descriptor>
									</descriptors>
								</configuration>
							</execution>
							<execution>
								<id>automatalib-bundle</id>
								<goals>
									<goal>single</goal>
								</goals>
								<phase>package</phase>
								<configuration>
									<descriptors>
										<descriptor>src/main/assembly/learnlib-automatalib-bundle.xml</descriptor>
									</descriptors>
								</configuration>
							</execution>
							<execution>
								<id>dependencies-bundle</id>
								<goals>
									<goal>single</goal>
								</goals>
								<phase>package</phase>
								<configuration>
									<descriptors>
										<descriptor>src/main/assembly/learnlib-dependencies-bundle.xml</descriptor>
									</descriptors>
								</configuration>
							</execution>
							<execution>
								<id>sources</id>
								<goals>
									<goal>single</goal>
								</goals>
								<phase>package</phase>
								<configuration>
									<descriptors>
										<descriptor>src/main/assembly/learnlib-sources-jar.xml</descriptor>
									</descriptors>
								</configuration>
							</execution>
						</executions>
					</plugin>

					<plugin>
						<groupId>org.apache.maven.plugins</groupId>
						<artifactId>maven-javadoc-plugin</artifactId>
						<inherited>false</inherited>
						<configuration>
							<finalName>learnlib-${project.version}</finalName>
							<jarOutputDirectory>${project.build.directory}/bundles</jarOutputDirectory>
							<includeDependencySources>true</includeDependencySources>
							<dependencySourceIncludes>
								<dependencySourceInclude>de.learnlib:*</dependencySourceInclude>
							</dependencySourceIncludes>
						</configuration>
						<executions>
							<execution>
								<id>aggregate</id>
								<goals>
									<goal>aggregate-jar</goal>
								</goals>
								<phase>package</phase>
							</execution>
						</executions>
					</plugin>

					<plugin>
						<groupId>com.atlassian.maven.plugins</groupId>
						<artifactId>maven-upload-plugin</artifactId>
						<inherited>false</inherited>
						<executions>
							<execution>
								<id>upload-bundles</id>
								<phase>deploy</phase>
								<goals>
									<goal>upload</goal>
								</goals>
								<configuration>
									<resourceSrc>${project.build.directory}/bundles/*</resourceSrc>
									<resourceDest>/files/releases/${project.version}</resourceDest>
								</configuration>
							</execution>
						</executions>
					</plugin>
				</plugins>
			</build>
		</profile>
	</profiles>

</project>
